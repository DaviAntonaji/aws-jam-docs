# 🛡️ Malware In your Bucket

## 📋 Visão Geral

Este desafio foca em **segurança de S3**, **automação serverless** e **detecção de malware** em arquivos enviados para buckets. Você precisará configurar um pipeline automatizado de escaneamento de arquivos usando AWS Lambda, Amazon S3 e CloudWatch Logs.

### 🎯 Cenário

Uma aplicação web permite que usuários façam upload de arquivos e fotos. No back-end, os arquivos são armazenados em um bucket Amazon S3. A aplicação precisa garantir que os arquivos recebidos estão livres de qualquer tipo de infecção por malware.

Uma ferramenta de escaneamento foi desenvolvida em Python e implantada em uma função Lambda chamada `bucket-scan-function`. No entanto, algo foi mal configurado e o escaneamento automático não está funcionando após a recriação do bucket S3.

## 🎓 O Que Você Vai Aprender

- ✅ Configurar gatilhos S3 → Lambda (Event Notifications)
- ✅ Gerenciar permissões IAM para Lambda (S3 + CloudWatch)
- ✅ Diagnosticar e resolver problemas de integração
- ✅ Analisar logs do CloudWatch
- ✅ Implementar pipelines de segurança serverless
- ✅ Entender arquitetura event-driven

## 🛠️ Serviços AWS Utilizados

- **Amazon S3:** Armazenamento de arquivos
- **AWS Lambda:** Execução da ferramenta de escaneamento
- **Amazon CloudWatch Logs:** Logs de execução e resultados
- **AWS IAM:** Permissões e políticas

## 📦 Inventário

- ✅ Um bucket S3 com nome que começa com `file-scanning-upload-`
- ✅ Uma função Lambda chamada `bucket-scan-function`
- ✅ Um arquivo de teste `test_file.txt` com vulnerabilidade conhecida
- ✅ CloudWatch Log Group para `/aws/lambda/bucket-scan-function`

## 🎯 Objetivos

### Task 1: Finding the infection (150 pontos)

Corrigir a configuração do sistema de escaneamento e identificar a vulnerabilidade no arquivo de teste.

**Meta:** Fazer upload do `test_file.txt` e obter o nome da vulnerabilidade detectada nos logs do CloudWatch.

## ⚠️ Observações Importantes

- ⏱️ A primeira execução pode levar ~30 segundos para o Log Group aparecer
- 📋 A resposta está no campo `detection_rule` do JSON de alerta
- 🔄 O gatilho S3 → Lambda foi removido e precisa ser reconfigurado
- 🔐 Verifique as permissões IAM da função Lambda

## 🏆 Critérios de Sucesso

- [ ] Gatilho S3 configurado corretamente
- [ ] Lambda com permissões adequadas (S3 GetObject + CloudWatch Logs)
- [ ] Upload de arquivo dispara automaticamente a função
- [ ] Logs aparecem no CloudWatch dentro de 30-60 segundos
- [ ] Vulnerabilidade identificada no campo `detection_rule`

## 📚 Recursos Úteis

- [AWS Lambda Event Notifications](https://docs.aws.amazon.com/lambda/latest/dg/with-s3.html)
- [S3 Event Notifications](https://docs.aws.amazon.com/AmazonS3/latest/userguide/NotificationHowTo.html)
- [CloudWatch Logs Insights](https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/AnalyzingLogData.html)
- [Lambda Execution Role](https://docs.aws.amazon.com/lambda/latest/dg/lambda-intro-execution-role.html)

## 🎯 Dificuldade

**⭐⭐⭐☆☆ Medium**

**Tempo estimado:** 30-45 minutos

---

**💡 Dica:** O problema não está no código da Lambda, mas na configuração da integração S3 → Lambda!
